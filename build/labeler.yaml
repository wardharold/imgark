steps:
- name: 'gcr.io/cloud-builders/go'
  args: ['install', './cmd/labeler']
  env: ["PROJECT_ROOT=github.com/wardharold/imgark", "CGO_ENABLED=0", "GOOS=linux"]
- name: 'gcr.io/cloud-builders/docker'
  args: ['build', '--file', 'containers/Dockerfile.labeler', '--tag=gcr.io/$PROJECT_ID/labeler', '.']
  id: 'labeler'
- name: 'gcr.io/cloud-builders/docker'
  args: ['tag', 'gcr.io/$PROJECT_ID/labeler', 'gcr.io/$PROJECT_ID/labeler:${_BRANCH_NAME}']
- name: 'gcr.io/cloud-builders/docker'
  args: ['tag', 'gcr.io/$PROJECT_ID/labeler', 'gcr.io/$PROJECT_ID/labeler:${_COMMIT_SHA}']

images: 
- 'gcr.io/$PROJECT_ID/labeler'
- 'gcr.io/$PROJECT_ID/labeler:${_BRANCH_NAME}'
- 'gcr.io/$PROJECT_ID/labeler:${_COMMIT_SHA}'
